---
title: Mysql - 数据库面试题打卡第六天
date: 2021-06-24 08:55:47
tags:
  - MySQL
  - 面经
categories:
  - MySQL
keywords:
  - MySQL
description: MySQL
headimg: https://cdn.jsdelivr.net/gh/xzMhehe/StaticFile_CDN/static/img/20210623101512.png
thumbnail: https://cdn.jsdelivr.net/gh/xzMhehe/StaticFile_CDN/static/img/20210623101512.png
---

## 51、MySQL 有关权限的表都有哪几个？
MySQL 服务器通过权限表来控制用户对数据库的访问，权限表存放在 MySQL 数据库里，由 MySQL_install_db 脚本初始化。这些权限表分别 user，db，table_priv，columns_priv 和 host。

## 52、MySQL 数据库作发布系统的存储，一天五万条以上的增量，预 计运维三年,怎么优化？
1、设计良好的数据库结构，允许部分数据冗余，尽量避免 join 查询，提高效率。              
2、选择合适的表字段数据类型和存储引擎，适当的添加索引。                 
3、MySQL 库主从读写分离。                 
4、找规律分表，减少单表中的数据量提高查询速度。                           
5、添加缓存机制，比如 memcached，apc 等。          
6、不经常改动的页面，生成静态页面。                     
7、书写高效率的 SQL。比如 SELECT * FROM TABEL 改为 SELECT ﬁeld_1,ﬁeld_2, ﬁeld_3 FROM TABLE.             

## 53、锁的优化策略
1、读写分离          
2、分段加锁          
3、减少锁持有的时间                
4.多个线程尽量以相同的顺序去获取资源不能将锁的粒度过于细化，不然可能会出现线程的加锁和释放 次数过多，反而效率不如一次加一把大锁。 

## 54、索引的底层实现原理和优化
B+树，经过优化的 B+树主要是在所有的叶子结点中增加了指向下一个叶子节点的指针，因此 InnoDB 建议为大部分表使用默认 自增的主键作为主索引。

## 55、什么情况下设置了索引但无法使用
1、以“%”开头的 LIKE 语句，模糊匹配                
2、OR 语句前后没有同时使用索引                 
3、数据类型出现隐式转化（如 varchar 不加单引号的话可能会自动转换为 int 型）               

## 56、实践中如何优化 MySQL
最好是按照以下顺序优化：         
1、SQL 语句及索引的优化          
2、数据库表结构的优化            
3、系统配置的优化          
4、硬件的优化                
详细可以查看 阿里 P8 架构师谈：MySQL 慢查询优化、索引优化、以及表等优化总结

## 57、优化数据库的方法
1、选取最适用的字段属性，尽可能减少定义字段宽度，尽量把字段设置 NOTNULL，例如’省份’、’性 别’最好适用 ENUM            
2、使用连接(JOIN)来代替子查询            
3、适用联合(UNION)来代替手动创建的临时表            
4、事务处理           
5、锁定表、优化事务处理           
6、适用外键，优化锁定表          
7、建立索引          
8、优化查询语句      

## 58、简单描述 MySQL 中，索引，主键，唯一索引，联合索引的区 别，对数据库的性能有什么影响（从读写两方面）
索引是一种特殊的文件(InnoDB 数据表上的索引是表空间的一个组成部分)，它们包含着对数据表里所 有记录的引用指针。

普通索引(由关键字 KEY 或 INDEX 定义的索引)的唯一任务是加快对数据的访问速度。

普通索引允许被索引的数据列包含重复的值。如果能确定某个数据列将只包含彼此各不相同的值，在为 这个数据列创建索引的时候就应该用关键字 UNIQUE 把它定义为一个唯一索引。也就是说，唯一索引 可以保证数据记录的唯一性。

主键，是一种特殊的唯一索引，在一张表中只能定义一个主键索引，主键用于唯一标识一条记录，使用 关键字 PRIMARY KEY 来创建。

索引可以覆盖多个数据列，如像 INDEX(columnA, columnB)索引，这就是联合索引。

索引可以极大的提高数据的查询速度，但是会降低插入、删除、更新表的速度，因为在执行这些写操作时，还要操作索引文件

## 59、数据库中的事务是什么?
事务（transaction）是作为一个单元的一组有序的数据库操作。如果组中的所有操作都成功，则认为事 务成功，即使只有一个操作失败，事务也不成功。如果所有操作完成，事务则提交，其修改将作用于所 有其他数据库进程。如果一个操作失败，则事务将回滚，该事务所有操作的影响都将取消。

事务特性：       
1、原子性：即不可分割性，事务要么全部被执行，要么就全部不被执行。        
2、一致性或可串性。事务的执行使得数据库从一种正确状态转换成另一种正确状态          
3、隔离性。在事务正确提交之前，不允许把该事务对数据的任何改变提供给任何其他事物             
4、持久性。事务正确提交后，其结果将永久保存在数据库中，即使在事务提交后有了其他故障，事务 的处理结果也会得到保存。          

**或者这样理解：**
事务就是被绑定在一起作为一个逻辑工作单元的 SQL 语句分组，如果任何一个语句操作失败那么整个 操作就被失败，以后操作就会回滚到操作前状态，或者是上有个节点。为了确保要么执行，要么不执
行，就可以使用事务。要将有组语句作为事务考虑，就需要通过 ACID 测试，即原子性，一致性，隔离 性和持久性。

## 60、SQL 注入漏洞产生的原因？如何防止？
SQL 注入产生的原因：程序开发过程中`不注意规范书写` sql 语句和对特殊字符进行过滤，导致客户端可 以通过全局变量 `POST 和 GET` 提交`一些 sql 语句`正常执行。
防止 SQL 注入的方式：
开启配置文件中的 magic_quotes_gpc 和 magic_quotes_runtime 设置 执行 sql 语句时使用 addslashes 进行 sql 语句转换

Sql 语句书写尽量不要省略双引号和单引号。                        
过滤掉 sql 语句中的一些关键词：update、insert、delete、select、 * 。

提高数据库表和字段的命名技巧，对一些重要的字段根据程序的特点命名，取不易被猜到的。


