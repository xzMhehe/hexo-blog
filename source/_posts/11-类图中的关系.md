---
title: 类图中的关系
date: 2022-07-05 14:06:44
tags:
  - 设计模式
categories:
  - 设计模式
keywords:
  - Java
description: 类图中的关系
---
## 类图中的关系

1. **关联关系**

关联(Association)关系是类与类之间最常用的一种关系，它是一种结构化关系，用于表示一类对象与另一类对象之间有联系，如汽车和轮胎、师傅和徒弟、班级和学生等等。在UML类图中，用实线连接有关联关系的对象所对应的类，在使用Java、C#和C++等编程语言实现关联关系时，**通常将一个类的对象作为另一个类的成员变量**。在使用类图表示关联关系时可以在关联线上标注角色名，一般使用一个表示两者之间关系的动词或者名词表示角色名（有时该名词为实例对象名），关系的两端代表两种不同的角色，因此在一个关联关系中可以包含两个角色名，角色名不是必须的，可以根据需要增加，其目的是使类之间的关系更加明确。

在UML中，关联关系通常又包含如下几种形式：

**(1) 双向关联**

默认情况下，关联是双向的。例如：顾客(Customer)购买商品(Product)并拥有商品，反之，卖出的商品总有某个顾客与之相关联。因此，Customer类和Product类之间具有双向关联关系，如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110132651.png" width="400"/>

**(2) 单向关联**

类的关联关系也可以是单向的，单向关联用带箭头的实线表示。例如：顾客(Customer)拥有地址(Address)，则Customer类与Address类具有单向关联关系，如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110132821.png" width="400"/>

**(3) 自关联**

在系统中可能会存在一些类的属性对象类型为该类本身，这种特殊的关联关系称为自关联。例如：一个节点类(Node)的成员又是节点Node类型的对象，如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110132845.png" width="300"/>

**(4) 多重性关联**

多重性关联关系又称为重数性(Multiplicity)关联关系，表示两个关联对象在数量上的对应关系。在UML中，对象之间的多重性可以直接在关联直线上用一个数字或一个数字范围表示。

对象之间可以存在多种多重性关联关系，常见的多重性表示方式如表所示：

| 表示方式 | 多重性说明                                                 |
| :------- | :--------------------------------------------------------- |
| 1..1     | 表示另一个类的一个对象只与该类的一个对象有关系             |
| 0..*     | 表示另一个类的一个对象与该类的零个或多个对象有关系         |
| 1..*     | 表示另一个类的一个对象与该类的一个或多个对象有关系         |
| 0..1     | 表示另一个类的一个对象没有或只与该类的一个对象有关系       |
| m..n     | 表示另一个类的一个对象与该类最少m，最多n个对象有关系 (m≤n) |

例如：一个界面(Form)可以拥有零个或多个按钮(Button)，但是一个按钮只能属于一个界面，因此，一个Form类的对象可以与零个或多个Button类的对象相关联，但一个Button类的对象只能与一个Form类的对象关联，如图所示

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110132912.png" width="400"/>

2. **聚合关系**

**聚合是关联关系的一种特例，他体现的是整体与部分、拥有的关系，即has-a的关系**，此时整体与部分之间是可分离的，他们可以具有各自的生命周期，部分可以属于多个整体对象，也可以为多个整体对象共享在UML中，聚合关系用带空心菱形的直线表示。例如：汽车发动机(Engine)是汽车(Car)的组成部分，但是汽车发动机可以独立存在，因此，汽车和发动机是聚合关系，如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110133006.png" width="400"/>

在代码实现聚合关系时，成员对象通常作为构造方法、Setter方法或业务方法的参数注入到整体对象中。

3. **组合关系**

**组合也是关联关系的一种特例，他体现的是一种contains-a的关系**，这种关系比聚合更强，也称为强聚合；他同样体现整体与部分间的关系，但此时整体与部分是不可分的，整体的生命周期结束也就意味着部分的生命周期结束。在UML中，组合关系用带实心菱形的直线表示。例如：人的头(Head)与嘴巴(Mouth)，嘴巴是头的组成部分之一，而且如果头没了，嘴巴也就没了，因此头和嘴巴是组合关系，如图所示

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110133040.png" width="400"/>



4. **依赖关系**

可以简单的理解，就是**一个类A使用到了另一个类B**，而这种使用关系是具有偶然性的、临时性的、非常弱的，但是B类的变化会影响到A；比如某人要过河，需要借用一条船，此时人与船之间的关系就是依赖；表现在代码层面，为类B作为参数被类A在某个method方法中使用；

在UML中，依赖关系用带箭头的虚线表示，由依赖的一方指向被依赖的一方。例如：驾驶员开车，在Driver类的drive()方法中将Car类型的对象car作为一个参数传递，以便在drive()方法中能够调用car的move()方法，且驾驶员的drive()方法依赖车的move()方法，因此类Driver依赖类Car，如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110133136.png" width="600"/>

5. **泛化关系**

**泛化(Generalization)关系也就是继承关系，用于描述父类与子类之间的关系**，父类又称作基类或超类，子类又称作派生类。在UML中，泛化关系用带空心三角形的直线来表示。在代码实现时，我们使用面向对象的继承机制来实现泛化关系，如在Java语言中使用extends关键字、在C++/C#中使用冒号“：”来实现。例如：Student类和Teacher类都是Person类的子类，Student类和Teacher类继承了Person类的属性和方法，Person类的属性包含姓名(name)和年龄(age)，每一个Student和Teacher也都具有这两个属性，另外Student类增加了属性学号(studentNo)，Teacher类增加了属性教师编号(teacherNo)，Person类的方法包括行走move()和说话say()，Student类和Teacher类继承了这两个方法，而且Student类还新增方法study()，Teacher类还新增方法teach()。如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110133213.png" width="600"/>

6. **实现关系**

接口之间也可以有与类之间关系类似的继承关系和依赖关系，但是接口和类之间还存在一种实现(Realization)关系，在这种关系中，**类实现了接口，类中的操作实现了接口中所声明的操作**。在UML中，类与接口之间的实现关系用带空心三角形的虚线来表示。例如：定义了一个交通工具接口Vehicle，包含一个抽象操作move()，在类Ship和类Car中都实现了该move()操作，不过具体的实现细节将会不一样，如图所示：

<img src="https://raw.githubusercontent.com/xzMhehe/StaticFile_CDN/main/static/mo/20220110133304.png" width="600" />

## **关系之间的区别**

1. 聚合与组合

（1）聚合与组合都是一种结合关系，只是额外具有整体-部分的意涵。
（2）部件的生命周期不同
聚合关系中，整件不会拥有部件的生命周期，所以整件删除时，部件不会被删除。再者，多个整件可以共享同一个部件。
组合关系中，整件拥有部件的生命周期，所以整件删除时，部件一定会跟着删除。而且，多个整件不可以同时间共享同一个部件。
（3）聚合关系是“has-a”关系，组合关系是“contains-a”关系。

2. 关联和聚合

（1）表现在代码层面，和关联关系是一致的，只能从语义级别来区分。
（2）关联和聚合的区别主要在语义上，关联的两个对象之间一般是平等的，例如你是我的朋友，聚合则一般不是平等的。
（3）关联是一种结构化的关系，指一种对象和另一种对象有联系。
（4）关联和聚合是视问题域而定的，例如在关心汽车的领域里，轮胎是一定要组合在汽车类中的，因为它离开了汽车就没有意义了。但是在卖轮胎的店铺业务里，就算轮胎离开了汽车，它也是有意义的，这就可以用聚合了。

3. 关联和依赖

（1）关联关系中，体现的是两个类、或者类与接口之间语义级别的一种强依赖关系，比如我和我的朋友；这种关系比依赖更强、不存在依赖关系的偶然性、关系也不是临时性的，一般是长期性的，而且双方的关系一般是平等的。
（2）依赖关系中，可以简单的理解，就是一个类A使用到了另一个类B，而这种使用关系是具有偶然性的、临时性的、非常弱的，但是B类的变化会影响到A。

4. 综合比较

这几种关系都是语义级别的，所以从代码层面并不能完全区分各种关系；但总的来说，后几种关系所表现的强弱程度依次为：
**组合>聚合>关联>依赖；**



